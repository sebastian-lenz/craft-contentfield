"use strict";function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){function n(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,e)})(e)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(e,t,n){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(a,n.prototype),a}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var contentField=function(e,t,n,r,a,i,o,l,s,c){function u(e,t){var n=e.schemas[t.__type];if(!n)throw new Error('Could not resolve schema "'.concat(t.__type,'".'));return n}function d(e){return e&&"object"===_typeof(e)&&"__type"in e&&"__uuid"in e}function f(e,t,n){if(d(n)&&n.__uuid===t)return{model:n,path:[],uuid:t};for(var r=u(e,n),a=0,i=Object.keys(r.fields);a<i.length;a++){var o=i[a],l=r.fields[o];if("array"===l.type&&"instance"===l.member.type){var s=n[o];if(!Array.isArray(s))continue;for(var c=0;c<s.length;c++){var h=f(e,t,s[c]);if(null!==h)return h.path.unshift({type:"index",name:o,index:c}),h}}else if("instance"===l.type){var p=f(e,t,n[o]);if(null!==p)return p.path.unshift({type:"property",name:o}),p}}return null}function h(e,t){return f(e,t,e.model)}function p(e){for(var t=[],n=e;n.length;){var r=/^([^\[\.]+)(?:\[(\d+)\])?\.?/.exec(n);if(!r)throw new Error('Invalid path segment "'.concat(n,'" in path "').concat(e,'".'));n=n.substr(r[0].length),3===r.length?t.push({index:parseInt(r[1]),name:r[2],type:"index"}):t.push({name:r[1],type:"property"})}return t}function m(e,t){if(!(t.name in e))return null;var n=e[t.name];return"index"===t.type?!Array.isArray(n)||t.index<0||t.index>=n.length?null:n[t.index]:n}function v(e,t){"string"==typeof t&&(t=p(t));for(var n=e,r=0;r<t.length;r++)if(!(n=m(n,t[r])))return n;return n}function g(e,t){var n=(t="string"==typeof t?p(t):t.slice()).pop();if(!n)return null;var r=v(e.model,t);if(!r)throw new Error("Could not resolve owner");var a=u(e,r),i="index"===n.type?n.index:void 0,o=a.fields[n.name];if(!o)throw new Error('Could not resolve field "'.concat(n.name,'" on schema "').concat(a.qualifier,'".'));return{field:o,index:i,owner:r,path:t,schema:a}}function y(e,t){return Craft.t("contentfield",e,t)}function C(){return null}function b(e){e.owner;return null}function E(e){e.owner;return null}function _(e,t,n){if(!t)return n(e);var r,a=e[t.name];if("index"===t.type){if(!Array.isArray(a))throw new Error("Invalid array access.");if(t.index<0||t.index>=a.length)throw new Error("Invalid array index ".concat(t.index,'".'));(r=a.slice())[t.index]=n(a[t.index])}else{if(Array.isArray(a))throw new Error("Invalid array access.");r=n(a)}var i=Object.assign({},e);return i[t.name]=r,i}function k(e,t,n){function r(e){return i=a.shift(),i?e?_(e,i,r):e:n(e)}var a="string"==typeof t?p(t):t.slice(),i=a.shift();return _(e,i,r)}function w(e,t,n){var r=e.fields[n].validatorId;if(!r)return null;var a=fr.getValidator(r);if(!a)return null;var i=[];return a(n,t[n],i),i}function S(e,t){if(d(t)){var n=e.schemas[t.__type];n&&(t.__errors=Object.keys(n.fields).reduce(function(e,r){var a=w(n,t,r);return a&&a.length&&(e[r]=a),e},{}))}}function x(e,t){var n=t.uuid,r=h(e,n);if(!r)return e;var a=g(e,r.path);if(!a||"array"!==a.field.type||void 0===a.index)return e;var i=a.field,o=a.index,l=a.path,s=i.name;return Object.assign({},e,{model:k(e.model,l,function(t){if(!(t&&s in t))return t;var n=t[s];if(!Array.isArray(n))return t;var r=_toConsumableArray(n);r.splice(o,1);var a=Object.assign({},t,_defineProperty({},s,r));return S(e,a),a})})}function O(e){return{type:"uuidRemove",uuid:e}}function N(e){var t=e.owner,n=e.location.uuid;return t&&"array"===t.field.type?{group:Rt.Manipulation,icon:"material:delete",id:"delete",invoke:function(e){e(O(n))},label:y("COMMAND_DELETE_LABEL")}:null}function R(e,t){var n=e.config.references.slice(),r=!0,a=!1,i=void 0;try{for(var o,l=t.references[Symbol.iterator]();!(r=(o=l.next()).done);r=!0)!function(){var e=o.value;n.some(function(t){var n=t.id,r=t.type;return e.id===n&&e.type===r})||(e.$element=$(e.element),e.hasThumb=e.$element.hasClass("hasthumb"),n.push(e))}()}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return Object.assign({},e,{config:Object.assign({},e.config,{references:n})})}function I(e){return{references:e,type:"addReferences"}}function A(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}function M(e){for(var t=e.schemas,n=e.schema,r=e.oldModel,a={__errors:{},__type:n.qualifier,__uuid:A()},i=0,o=Object.keys(n.fields);i<o.length;i++){var l=o[i],s=n.fields[l],c=It.getDefinition(s),u=r&&l in r?r[l]:void 0;void 0!==u&&c.isValue(s,u)||(u=c.createValue({field:s,schemas:t})),a[l]=u}return a}function P(e,t){var n=e.schemas[t.newType];return n?Object.assign({},e,{model:k(e.model,t.path,function(t){return M({oldModel:t,schema:n,schemas:e.schemas})})}):e}function T(e,t){return{newType:t,path:e,type:"changeType"}}function j(e){return null!==e&&"object"===_typeof(e)}function L(e,t){var n=t.source,r=t.target,a=t.targetField,i=t.targetIndex,o=Array.isArray(n)?n.slice():p(n),l=Array.isArray(r)?r.slice():p(r),s=e.model,c=v(s,o),u=j(c)?Object.assign({},c):c,d=o.pop();if(!d||"index"!==d.type)throw new Error("Unsupported operation");return j(c)||(c=new Object,s=k(s,o,function(e){if(!e)throw new Error("Invalid operation");var t=e[d.name];if(!Array.isArray(t))throw new Error("Invalid operation");return t=t.slice(),t[d.index]=c,Object.assign({},e,_defineProperty({},d.name,t))})),s=k(s,l,function(e){if(!e)throw new Error("Could not find target");var t=e[a];if(!Array.isArray(t))throw new Error("Unsupported operation");return t=t.slice(),i>=t.length?t.push(u):t.splice(i,0,u),Object.assign({},e,_defineProperty({},a,t))}),s=k(s,o,function(e){if(!e)throw new Error("Could not find source");var t=e[d.name];if(!Array.isArray(t))throw new Error("Unsupported operation");return t=t.filter(function(e){return e!==c}),Object.assign({},e,_defineProperty({},d.name,t))}),Object.assign({},e,{model:s})}function D(e){return Object.assign({},e,{type:"moveModel"})}function U(e,t){var n=t.overlay;return Object.assign({},e,{overlay:n})}function W(e){return{overlay:e,type:"setOverlay"}}function V(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function F(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(o,l)}s((r=r.apply(e,t||[])).next())})}function z(e){var t=e.source,n=V(e,["source"]);return F(this,void 0,void 0,regeneratorRuntime.mark(function e(){var r,a,i,o,l,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.schemas[t.__type]){e.next=3;break}throw new Error("Invalid source schema.");case 3:a={__errors:{},__originalUuid:t.__uuid,__type:r.qualifier,__uuid:A()},i=0,o=Object.keys(r.fields);case 5:if(!(i<o.length)){e.next=15;break}return l=o[i],s=r.fields[l],c=It.getDefinition(s),e.next=11,c.cloneValue(Object.assign({},n,{field:s,value:t[l]}));case 11:a[l]=e.sent;case 12:i++,e.next=5;break;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)}))}function H(e){return"object"===_typeof(e)&&"object"===_typeof(e.data)&&!0===e.result&&Array.isArray(e.references)}function B(e){var t=e.apiEndpoint,n=V(e,["apiEndpoint"]),r=Object.keys(n).map(function(e){return"".concat(e,"=").concat(encodeURIComponent(n[e]))}).join("&");return new Promise(function(e,n){fetch("".concat(t,"&").concat(r)).then(function(e){return e.json()}).then(function(t){H(t)?e(t):n(t&&t.message?"".concat(t.message):"An unknown error has occured.")}).catch(function(e){n("".concat(e))})})}function q(e){if(!Array.isArray(e))return[];var t=[],n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value;d(l)&&t.push(l)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}function X(e,t){return e.__uuid===t.__uuid||e.__uuid===t.__originalUuid||e.__originalUuid===t.__uuid||e.__originalUuid===t.__originalUuid}function Y(e){var t=e.field,n=e.source,r=e.target,a=V(e,["field","source","target"]);return F(this,void 0,void 0,regeneratorRuntime.mark(function e(){var i,o,l,s,c,u,d,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("instance"===t.member.type){e.next=2;break}return e.abrupt("return",n||[]);case 2:i=q(n),o=q(r),l=[],s=!0,c=!1,u=void 0,e.prev=8,d=regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.value,n=o.findIndex(function(e){return X(e,t)}),r=void 0,-1!==n){e.next=9;break}return e.next=6,z(Object.assign({},a,{source:t}));case 6:r=e.sent,e.next=12;break;case 9:return e.next=11,G(Object.assign({},a,{source:t,target:o[n]}));case 11:r=e.sent;case 12:r&&l.push(r);case 13:case"end":return e.stop()}},e)}),f=i[Symbol.iterator]();case 11:if(s=(h=f.next()).done){e.next=16;break}return e.delegateYield(d(),"t0",13);case 13:s=!0,e.next=11;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(8),c=!0,u=e.t1;case 22:e.prev=22,e.prev=23,s||null==f.return||f.return();case 25:if(e.prev=25,!c){e.next=28;break}throw u;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",l);case 31:case"end":return e.stop()}},e,null,[[8,18,22,30],[23,,25,29]])}))}function G(e){var t=e.source,n=e.target,r=V(e,["source","target"]);return F(this,void 0,void 0,regeneratorRuntime.mark(function e(){var a,i,o,l,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d(t)){e.next=2;break}return e.abrupt("return",n);case 2:if(d(n)&&n.__type===t.__type){e.next=4;break}return e.abrupt("return",z(Object.assign({},r,{source:t})));case 4:if(a=r.schemas[t.__type]){e.next=7;break}throw new Error("Invalid schema");case 7:i=Object.assign({},n),o=0,l=Object.keys(a.fields);case 9:if(!(o<l.length)){e.next=25;break}if(s=l[o],"array"!==(c=a.fields[s]).type){e.next=18;break}return e.next=15,Y(Object.assign({},r,{field:c,source:t[s],target:n[s]}));case 15:i[s]=e.sent,e.next=22;break;case 18:if("instance"!==c.type){e.next=22;break}return e.next=21,G(Object.assign({},r,{source:t[s],target:n[s]}));case 21:i[s]=e.sent;case 22:o++,e.next=9;break;case 25:return e.abrupt("return",i);case 26:case"end":return e.stop()}},e)}))}function K(e,t){var n=t.sync;return Object.assign({},e,{sync:n})}function Q(e){return{sync:e,type:"updateSync"}}function J(e,t){var n=t.path,r=t.key,a=t.value;return Object.assign({},e,{model:k(e.model,n,function(t){var n=r?Object.assign({},t,_defineProperty({},r,a)):a;return S(e,n),n})})}function Z(e,t,n){return{path:e,key:t,type:"updateValue",value:n}}function ee(e,t,n){var r=e.siteId,a=e.translate;return F(this,void 0,void 0,regeneratorRuntime.mark(function e(){var i,o,l,s,c,u,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t(Q({status:"working"})),i=n(),o=i.config,l=i.model,s=i.schemas,"number"==typeof o.elementId){e.next=4;break}throw new Error("Entry must be saved before it can be synchronized.");case 4:return e.next=6,B({apiEndpoint:o.apiEndpoints.fetchSite,elementId:o.elementId,fieldHandle:o.fieldHandle,siteId:r});case 6:if(c=e.sent,u=c.data,f=c.references,d(u)&&o.rootSchemas.some(function(e){return e===u.__type})){e.next=11;break}throw new Error("Selected target site does not contain a valid model.");case 11:if(d(l)&&l.__type===u.__type){e.next=17;break}return e.next=14,z({schemas:s,source:u,translate:a});case 14:e.t0=e.sent,e.next=20;break;case 17:return e.next=19,G({schemas:s,source:u,target:l,translate:a});case 19:e.t0=e.sent;case 20:h=e.t0,t(I(f)),t(Z([],void 0,h)),t(Q({status:"finished"}));case 24:case"end":return e.stop()}},e)}))}function te(e){var t=this;return function(n,r){return F(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee(e,n,r);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),n(Q({status:"error",message:"".concat(t.t0)}));case 8:case"end":return t.stop()}},t,null,[[0,5]])}))}}function ne(e,t){var n=t.direction,r=t.uuid,a=h(e,r);if(!a)return e;var i=g(e,a.path);if(!i||"array"!==i.field.type||void 0===i.index)return e;var o=i.field,l=i.index,s=i.path,c=o.name;return Object.assign({},e,{model:k(e.model,s,function(t){if(!(t&&c in t))return t;var r=t[c];if(!Array.isArray(r))return t;var a=l+("up"===n?-1:1),i=_toConsumableArray(r),o=i.splice(l,1);i.splice.apply(i,[a,0].concat(_toConsumableArray(o))),console.log(l,a,o);var s=Object.assign({},t,_defineProperty({},c,i));return S(e,s),s})})}function re(e,t){return{direction:t,type:"uuidOrder",uuid:e}}function ae(e){var t=e.location.uuid;return{group:Rt.Manipulation,icon:"material:edit",id:"edit",invoke:function(e){e(W({type:"edit",uuid:t}))},label:y("COMMAND_EDIT_LABEL")}}function ie(e){var t=e.location.uuid,n=e.owner;if(!n||"array"!==n.field.type)return null;var r=n.owner[n.field.name];return!Array.isArray(r)||void 0===n.index||n.index>=r.length-1?null:{group:Rt.Movement,icon:"material:arrow_downward",id:"moveDown",invoke:function(e){return e(re(t,"down"))},label:y("COMMAND_MOVE_DOWN_LABEL")}}function oe(e){var t=e.location.uuid,n=e.owner;if(!n||"array"!==n.field.type)return null;var r=n.owner[n.field.name];return!Array.isArray(r)||void 0===n.index||n.index<=0?null:{group:Rt.Movement,icon:"material:arrow_upward",id:"moveUp",invoke:function(e){return e(re(t,"up"))},label:y("COMMAND_MOVE_UP_LABEL")}}function le(e){e.owner;return null}function se(e,t){var n=h(e,t),r=[];if(!n)return r;var a={location:n,owner:g(e,n.path),state:e};return Mt.map(function(e){return e(a)}).filter(function(e){return null!==e})}function ce(e,t){var n=t.uuid,r=null;return{getCommands:function(){return se(e.getState(),n).map(function(t){return Object.assign({},t,{invoke:function(){return t.invoke(e.dispatch)}})})},subscribe:function(t){r&&r(),r=e.subscribe(t)},unsubscribe:function(){r&&r(),r=null}}}function ue(e){Tt=e}function de(){return Tt}function fe(){if(!Tt)throw new Error("Api key missing.");return Lt||(Lt=new Promise(function(e){window.onGoogleMapsReady=function(){Dt=Pt.Loaded,e(google.maps)};var t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?key=".concat(Tt,"&libraries=places&callback=onGoogleMapsReady"),(document.head||document.body).appendChild(t),Lt=Lt,Dt=Pt.Loading}))}function he(t,n){var r=JSON.parse(t.innerHTML);r.sync={status:"idle"},r.config.expanded=[],r.config.references=r.config.references.map(function(t){var n=e(t.element);return Object.assign({},t,{$element:n,hasThumb:n.hasClass("hasthumb")})});for(var a=0,i=Object.keys(r.schemas);a<i.length;a++){var o=i[a],l=r.schemas[o];"string"==typeof l.preview?l.previewTemplate=Nt.compile(l.preview):l.previewTemplate=null}ue(r.config.googleMapsApiKey);var s=void 0;1===r.config.rootSchemas.length&&(s=r.schemas[r.config.rootSchemas[0]]);try{r.model=JSON.parse(n.value)}catch(e){}return!s||d(r.model)&&r.model.__type===s.qualifier||(r.model=M({oldModel:r.model,schema:s,schemas:r.schemas})),r}function pe(e){var t=e.children,r=e.onClick,a=e.secondary;return n.createElement("div",{className:Ut("tcfButton btn",{secondary:a}),onClick:function(e){e.preventDefault(),r()}},t)}function me(e){var t=e.field,r=It.getDefinition(t).widget;return n.createElement(r,e)}function ve(e){var t=e.children,r=e.isBorderless,a=e.label,i=e.style;return a&&""!==a&&a!==Wt?n.createElement("div",{className:"tcfFieldGroup",style:i},n.createElement("div",{className:"tcfFieldGroup--label"},a),n.createElement("div",{className:"tcfFieldGroup--content"},t)):n.createElement("div",{className:Ut("tcfFieldGroup--content",{isBorderless:r}),style:i},t)}function ge(e){var t,r=e.children,a=e.className,i=e.errors,o=e.instructions,l=e.isPlainField,s=e.isRequired,c=e.label,u=e.width;if(u&&100!==u&&(t={width:"string"==typeof u?u:"".concat(u,"%")}),l)return n.createElement(n.Fragment,null,r);var d=i&&i.length;return n.createElement("div",{className:Ut("tcfFieldPanel",a),style:t},n.createElement("div",{className:Ut("tcfFieldPanel--label",{hasErrors:d,isRequired:s})},c),o?n.createElement("div",{className:"tcfFieldPanel--instructions"},o):null,i&&i.length?n.createElement("ul",{className:"tcfFieldPanel--errors"},i.map(function(e,t){return n.createElement("li",{className:"tcfFieldPanel--error",key:t},e)})):null,r)}function ye(e){var t=e.children,r=V(e,["children"]),a=_slicedToArray(n.useState(jt.Large),2),i=a[0],o=a[1],l=n.useRef(null);return n.useEffect(function(){var e=window.ResizeObserver,t=l.current,n=-1,r=0;if(t){var a=function(){var e=t.offsetWidth;e!==r&&o((r=e)>920?jt.Large:jt.Small)};if(e){var i=new e(a);return i.observe(t),function(){return i.unobserve(t)}}return function e(){n=window.requestAnimationFrame(e),a()}(),function(){return window.cancelAnimationFrame(n)}}},[]),n.createElement("div",Object.assign({ref:l},r),n.createElement(Vt.Provider,{value:i},t))}function Ce(e,t){return e.index-t.index}function be(e){var t=e.isBorderless,r=e.model,a=e.onUpdate,i=e.path,o=e.schema,l=n.useContext(Vt);if(!o)return n.createElement("div",null,'Could not resolve schema for "'.concat(r.__type,'"'));for(var s=[],c=l==jt.Large,u=void 0,d=0,f=Object.keys(o.fields);d<f.length;d++)!function(){var e=f[d],l=o.fields[e],h=r.__errors[e]||null,p=It.getDefinition(l).isAlwaysPlainField;if(!u||l.group){var m=l.group?l.group.label:void 0,v=l.group&&c?l.group.style:void 0;u={index:m===Wt?-1:s.length,label:m,fields:[],style:v},s.push(u)}u.fields.push(n.createElement(ge,{errors:h,instructions:l.instructions,isPlainField:t||p,isRequired:l.isRequired,key:l.name,label:l.label,width:c?l.width:void 0},n.createElement(me,{data:r[l.name],errors:h,field:l,model:r,onUpdate:function(t){return a(e,t)},path:i})))}();var h=s.sort(Ce).map(function(e){return n.createElement(ve,{isBorderless:t,key:e.index,label:e.label,style:c?e.style:void 0},e.fields)}),p=o.grid;return p&&c?n.createElement("div",{className:"tcfInstanceForm",style:{grid:p}},h):n.createElement(n.Fragment,null,h)}function Ee(e){var t=e.children;return n.createElement("div",{className:"tcfWindow"},t)}function _e(e){var t=e.className,r=e.params,a=e.value;return n.createElement("span",{className:t},y(a,r))}function ke(e){var t=e.children,r=_slicedToArray(n.useState([]),2),a=r[0],i=r[1],o=function(e){return-1!==a.indexOf(e)},l=function(e,t){var n=_toConsumableArray(a);void 0===t&&(t=-1===a.indexOf(e)),t?n.push(e):n=n.filter(function(t){return t!==e}),i(n)};return n.createElement(Ht.Provider,{value:{expanded:a,isExpanded:o,toggleExpanded:l}},t)}function we(e){if(!e)return null;switch(e.type){case"edit":return n.createElement(qt,Object.assign({},e))}}function Se(e){var t=e.className,r=e.name,a=e.size,i="craft";return r.startsWith(Yt)?(i="material",r=r.substr(Yt.length)):r.startsWith(Xt)&&(r=r.substr(Xt.length)),n.createElement("div",{className:Ut("tcfIcon",t,i,a)},r)}function xe(e){var t=e.children,r=n.useContext($t);return n.createElement($t.Provider,{value:r+1},t)}function Oe(e,t){return e.label.localeCompare(t.label)}function Ne(e){var t=e.allowUndecided,r=e.options,a=e.value,i=e.onChange,o=r.findIndex(function(e){return e.key===a}),l=t||-1===o;return n.createElement("div",{className:"tcfSelect"},n.createElement("select",{className:"tcfSelect--select",value:-1==o?void 0:o,onChange:function(e){var n=e.target.selectedIndex,a=null;l&&(n-=1),n>=0&&n<r.length&&(a=r[n].key),(null!==a||t)&&i(a)}},l?n.createElement("option",null,"(None)"):null,r.map(function(e,t){return n.createElement("option",{key:t,value:t},e.indent?"--".repeat(e.indent)+" ":null,e.label)})))}function Re(e){var t,r=e.canChangeType,a=void 0===r||r,i=e.isBorderless,o=e.model,l=e.onChangeType,s=e.path,c=e.schemas,u=!1;if(d(o)&&(u=c.some(function(e){return e.qualifier===o.__type})),a&&c.length>1){var f=c.map(function(e){return{key:e.qualifier,label:e.label}});f.sort(Oe),t=n.createElement(ge,{className:"tcfInstance--typeSelect",label:"Type"},n.createElement(Ne,{onChange:l,options:f,value:u?o.__type:null}))}return n.createElement(xe,null,t,u?n.createElement(Ft,{model:o,isBorderless:i,path:s}):null)}function Ie(e){var t=e.message,r=e.onClose;return n.createElement("div",{className:"tcfSynchronize--message"},n.createElement(Se,{className:"tcfSynchronize--messageIcon error",name:"material:error",size:"huge"}),n.createElement("div",{className:"tcfSynchronize--title"},"An error has occured"),t?n.createElement("div",{className:"tcfSynchronize--message"},t):null,n.createElement("div",{className:"tcfSynchronize--actions"},n.createElement(pe,{onClick:r},"Close")))}function Ae(e){var t=e.onClose;return n.createElement("div",{className:"tcfSynchronize--message"},n.createElement(Se,{className:"tcfSynchronize--messageIcon finished",name:"material:check_circle",size:"huge"}),n.createElement("div",{className:"tcfSynchronize--title"},"Sites have been synchronized"),n.createElement("div",{className:"tcfSynchronize--message"},"If you are not happy with the results, do not save the entry. Reload this page to revert all changes."),n.createElement("div",{className:"tcfSynchronize--actions"},n.createElement(pe,{onClick:t},"Close")))}function Me(){return n.createElement("div",{className:"tcfActivityIndicator"},n.createElement("div",{className:"tcfActivityIndicator--bounce first"}),n.createElement("div",{className:"tcfActivityIndicator--bounce second"}),n.createElement("div",{className:"tcfActivityIndicator--bounce third"}))}function Pe(){return n.createElement("div",{className:"tcfSynchronize--working"},n.createElement(Me,null))}function Te(e){var t,r=e.onClose,a=e.sync;return t="working"===a.status?n.createElement(Pe,null):"error"===a.status?n.createElement(Ie,{message:a.message,onClose:r}):"finished"===a.status?n.createElement(Ae,{onClose:r}):n.createElement(Zt,{onClose:r}),n.createElement("div",{className:"tcfSynchronize"},t)}function je(){return{config:{apiEndpoints:{fetchSite:"",oembed:"",translate:""},elementId:null,elementSiteId:0,fieldHandle:"",i18nCategory:"site",references:[],rootSchemas:[],supportedSites:[]},model:{__errors:{},__type:"unknown",__uuid:"0"},overlay:null,schemas:{},sync:{status:"idle"}}}function Le(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je(),t=arguments.length>1?arguments[1]:void 0;return t.type in At?At[t.type](e,t):e}function De(e){for(;"string"!=typeof e;)e=e.toHTML();return e}function Ue(e){var t=e.context,n=e.field,r=e.value;if(!n)return[];var a=n.member,i=It.getDefinition(a);return r.map(function(e){return i.preview({value:e,field:a,context:t})})}function We(e){return o.DragSource("MEMBER",{beginDrag:function(e,t,n){var r=a.findDOMNode(n);return{data:e.child,height:r?r.clientHeight:0,path:e.path}}},function(e,t){return{dragPreview:e.dragPreview(),dragSource:e.dragSource(),hasDropTarget:t.isDragging()&&t.getTargetIds().length>0,isDragging:t.isDragging()}})(e)}function Ve(e,t){return e.name===t.name&&e.type===t.type&&("index"!==e.type||"index"!==t.type||e.index===t.index)}function Fe(e,t){return e.length===t.length&&e.every(function(e,n){return Ve(e,t[n])})}function ze(e){var t=e.children,r=e.onClick,a=e.primary;return n.createElement("div",{className:Ut("tcfArrayWidgetMember--headerActionsButton",{primary:a}),onClick:function(e){e.preventDefault(),r()}},t)}function He(e){var t=e.command,r=e.onClick;return n.createElement("div",{className:"tcfArrayWidgetMember--headerMoreItem",onClick:r},n.createElement(Se,{className:"tcfArrayWidgetMember--headerMoreItemIcon",name:t.icon}),n.createElement("span",{className:"tcfArrayWidgetMember--headerMoreItemLabel"},t.label))}function Be(e){var t,r=e.commands,a=e.dispatch,i=e.onClose,o=[],l=!0,s=!1,c=void 0;try{for(var u,d=r[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){(function(){var e=u.value;if("edit"===e.id)return"continue";void 0!==t&&t!==e.group&&o.push(n.createElement("div",{className:"tcfArrayWidgetMember--headerMoreDivider",key:"".concat(e.id,"-divider")})),t=e.group,o.push(n.createElement(He,{command:e,key:e.id,onClick:function(){i(),e.invoke(a)}}))})()}}catch(e){s=!0,c=e}finally{try{l||null==d.return||d.return()}finally{if(s)throw c}}return n.createElement("div",{className:"tcfArrayWidgetMember--headerMoreMenu"},o)}function qe(e){var t=e.dragSource,r=e.isCollapsible,a=e.isExpanded,i=e.model,o=e.onToggleExpanded,l=e.schema,s=[];return l?(s.push(n.createElement(Se,{key:"schemaIcon",name:l.icon})),s.push(n.createElement("span",{key:"schemaLabel"},l.label))):s.push(n.createElement(Se,{className:"tcfArrayWidgetMember--headerHandleIcon",key:"handle",name:"move"})),n.createElement("div",{className:"tcfArrayWidgetMember--header"},t(n.createElement("div",{className:"tcfArrayWidgetMember--headerHandle"},s)),n.createElement("div",{className:"tcfArrayWidgetMember--headerActions"},r?n.createElement(ze,{onClick:o,primary:!0},n.createElement(Se,{name:a?"done":"edit"}),n.createElement(_e,{value:a?"ARRAY_MEMBER_COLLAPSE":"ARRAY_MEMBER_EXPAND"})):null,n.createElement(cn,{uuid:i.__uuid})))}function Xe(e){for(var t=0;e.previousElementSibling;)(e=e.previousElementSibling).classList.contains("tcfArrayWidgetList--placeholder")||(t+=1);return t}function Ye(e){if(!e)return e;if(Array.isArray(e))return e.map(function(e){return Ye(e)});if("object"===_typeof(e)){var t={};for(var n in e)t[n]=Ye(e[n]);return t}return e}function $e(e){var t=e.field,r=e.label,a=e.onCreate,i=e.schemas;return n.createElement("div",{className:"tcfFactory"},n.createElement(pe,{onClick:function(){var e=It.createValue({field:t,schemas:i});a(e)},secondary:!0},n.createElement(_e,{value:r||"Create"}),n.createElement(Se,{name:"plus"})))}function Ge(e){var t=e.data,r=e.field,a=e.onUpdate;return n.createElement(Qt,{onChange:a,value:!!t},r.label)}function Ke(e){var t=e.red,n=e.green,r=e.blue,a=e.alpha;return{max:Math.max(t,n,r),min:Math.min(t,n,r),red:t/255,green:n/255,blue:r/255,alpha:a}}function Qe(){return{alpha:1,blue:255,green:255,red:255}}function Je(e){return"object"===_typeof(e)&&"number"==typeof e.alpha&&"number"==typeof e.blue&&"number"==typeof e.green&&"number"==typeof e.red}function Ze(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,r){return t+t+n+n+r+r});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16),alpha:1}:null}function et(e){var t=e.alpha,n=e.hue,r=e.saturation,a=e.value,i=0,o=0,l=0,s=Math.floor(6*n),c=6*n-s,u=a*(1-r),d=a*(1-c*r),f=a*(1-(1-c)*r);switch(s%6){case 0:i=a,o=f,l=u;break;case 1:i=d,o=a,l=u;break;case 2:i=u,o=a,l=f;break;case 3:i=u,o=d,l=a;break;case 4:i=f,o=u,l=a;break;case 5:i=a,o=u,l=d}return{alpha:t,red:Math.round(255*i),green:Math.round(255*o),blue:Math.round(255*l)}}function tt(e){return"rgba(".concat(e.red,",").concat(e.green,",").concat(e.blue,",").concat(e.alpha,")")}function nt(e){return"#"+(16777216+(e.blue|e.green<<8|e.red<<16)).toString(16).slice(1)}function rt(e){var t=Ke(e),n=t.alpha,r=t.blue,a=t.green,i=t.max,o=t.min,l=t.red,s=0===i?0:(i-o)/i,c=(i-o)/255,u=0,d=i/255;return i===o?{hue:u,saturation:s,value:d,alpha:n}:(u=i===e.red?(a-r)/c+(a<r?6:0):i===e.green?(r-l)/c+2:(l-a)/c+4,u/=6,{hue:u,saturation:s,value:d,alpha:n})}function at(e){return function(t){return n.createElement(kn.Consumer,null,function(r){return n.createElement(e,Object.assign({},t,r))})}}function it(e){var t=e.className,r=V(e,["className"]);return n.createElement("input",Object.assign({className:Ut("tcfInput",t)},r))}function ot(e){var t=e.children,r=e.className,a=e.color,i=e.css,o=e.onClick,l=e.onRgbColor;if(a){var s=Ze(a);s&&(o=function(){l(s)})}return n.createElement("div",{className:Ut("tcfColorInputSwatch",r),onClick:o},n.createElement("div",{className:"tcfColorInputSwatch--color",style:{background:a||i}}),t)}function lt(e){var t=e.disableAlpha,r=e.presetColors,a=[n.createElement("div",{className:"tcfColorInputPicker--value wide",key:"hex"},n.createElement(Sn,{type:"hex"}),n.createElement("div",{className:"tcfColorInputPicker--valueCaption"},"Hex")),n.createElement("div",{className:"tcfColorInputPicker--value",key:"red"},n.createElement(Sn,{type:"red"}),n.createElement("div",{className:"tcfColorInputPicker--valueCaption"},"R")),n.createElement("div",{className:"tcfColorInputPicker--value",key:"green"},n.createElement(Sn,{type:"green"}),n.createElement("div",{className:"tcfColorInputPicker--valueCaption"},"G")),n.createElement("div",{className:"tcfColorInputPicker--value",key:"blue"},n.createElement(Sn,{type:"blue"}),n.createElement("div",{className:"tcfColorInputPicker--valueCaption"},"B"))];t||a.push(n.createElement("div",{className:"tcfColorInputPicker--value",key:"alpha"},n.createElement(Sn,{type:"alpha"}),n.createElement("div",{className:"tcfColorInputPicker--valueCaption"},"A")));var i=null;return r&&r.length&&(i=n.createElement("div",{className:"tcfColorInputPicker--presets"},r.map(function(e){return n.createElement(Nn,{className:"tcfColorInputPicker--presetsSwatch",color:e})}))),n.createElement("div",{className:"tcfColorInputPicker"},n.createElement(xn,null),n.createElement("div",{className:"tcfColorInputPicker--controls"},n.createElement("div",{className:"tcfColorInputPicker--sliders"},n.createElement(On,{type:"hue"}),t?null:n.createElement(On,{type:"alpha"})),n.createElement(Nn,{className:"tcfColorInputPicker--swatch"})),n.createElement("div",{className:"tcfColorInputPicker--values"},a),i)}function st(e){var t=e.data,r=e.field,a=e.onUpdate,i=Je(t)?t:Qe();return n.createElement(Rn,{color:i,disableAlpha:r.disableAlpha,onChange:a,presetColors:r.presetColors})}function ct(e,t,n){function r(){var c=Date.now()-a;c<t&&c>=0?o=window.setTimeout(r,t-c):(o=null,n||(i=e.apply(s,l),o||(s=l=null)))}var a,i,o=null,l=null,s=null;return function(){s=this,l=arguments,a=Date.now();var c=n&&!o;return o||(o=window.setTimeout(r,t)),c&&(i=e.apply(s,l),s=l=null),i}}function ut(e){var t=e.children,r=e.className,a=e.icon;return n.createElement("div",{className:Ut("tcfTextAndIcon",r)},n.createElement(Se,{className:"tcfTextAndIcon--icon",name:a}),n.createElement(_e,{className:"tcfTextAndIcon--text",value:t}))}function dt(e){var t=e.children,r=e.title;return n.createElement("div",{className:"tcfErrorMessage"},n.createElement(ut,{icon:"material:error"},r),t)}function ft(e){return"object"===_typeof(e)&&"string"==typeof e.url}function ht(e){var t=e.className,r=e.data,a=e.field,i=e.path;return n.createElement("div",{className:Ut("tcfInstanceWidget",t)},n.createElement(Gt,{model:r,path:[].concat(_toConsumableArray(i),[{type:"property",name:a.name}]),schemaNames:a.schemas}))}function pt(e){var t=e.data,r=e.field,a=e.onUpdate;return n.createElement(Un,{onChange:a,value:!!t},r.label)}function mt(e){var t=e.link,r=e.linkType,a=e.onUpdate;return n.createElement(Fn,{criteria:r.criteria,data:[t.elementId],elementType:r.elementType,limit:1,onUpdate:function(e){return a(Object.assign({},t,{elementId:e.length?e[0]:0}))},sources:r.sources,viewMode:"small"})}function vt(e){var t=e.link,r=e.linkType,a=e.onUpdate;return n.createElement(it,{type:r.inputType,value:t.url,onChange:function(e){return a(Object.assign({},t,{url:e.currentTarget.value}))}})}function gt(e){return"object"===_typeof(e)&&"number"==typeof e.elementId&&"string"==typeof e.type&&"string"==typeof e.url}function yt(e){var t,r=e.data,a=e.field,i=e.onUpdate;t=gt(r)?r:{elementId:0,openInNewWindow:!1,type:"",url:""};var o,l=a.linkTypes[t.type];l&&"input"===l.type?o=n.createElement(vt,{key:t.type,link:t,linkType:l,onUpdate:i}):l&&"element"===l.type&&(o=n.createElement(mt,{key:t.type,link:t,linkType:l,onUpdate:i}));var s=a.allowNewWindow;return n.createElement("div",{className:"tcfLinkWidget"},n.createElement("div",{className:"tcfLinkWidget--type"},n.createElement(Ne,{options:Object.keys(a.linkTypes).map(function(e){return{key:e,label:a.linkTypes[e].label}}),value:t.type,onChange:function(e){return i(Object.assign({},t,{type:e}))}})),n.createElement("div",{className:"tcfLinkWidget--editor"},o),s?n.createElement(Qt,{onChange:function(e){return i(Object.assign({},t,{openInNewWindow:e}))},value:t.openInNewWindow},n.createElement(_e,{value:"FIELD_LINK_NEW_WINDOW"})):null)}function Ct(e){var t=e.results,r=e.onSelect;return n.createElement("div",{className:""},t.map(function(e){return n.createElement("div",{onClick:function(){return r(e)}},e.formatted_address)}))}function bt(e){return"object"===_typeof(e)&&"number"==typeof e.latitude&&"number"==typeof e.longitude}function Et(e,t){return F(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,a,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(Jn>2)){n.next=3;break}return console.warn('Translator has returned to many errors, skipping translation for text "'.concat(e,'".')),n.abrupt("return",e);case 3:return r=t.endpoint,a=V(t,["endpoint"]),i=Object.assign({},a,{text:e}),o=Object.keys(i).map(function(e){return"".concat(e,"=").concat(encodeURIComponent(i[e]))}).join("&"),n.abrupt("return",new Promise(function(t){fetch("".concat(r,"&").concat(o)).then(function(e){return e.json()}).then(function(n){t(n&&n.data?n.data:e)}).catch(function(n){console.error("Translator returned an error: ".concat(n)),Jn+=1,t(e)})}));case 7:case"end":return n.stop()}},n)}))}function _t(e){var t=e.context.references,n=e.field,r=e.value,a=[];if(!n)return a;var i=n.elementType,o=!0,l=!1,s=void 0;try{for(var c,u=r[Symbol.iterator]();!(o=(c=u.next()).done);o=!0)!function(){var e=c.value,n=t.find(function(t){return t.id===e&&t.type===i});n&&a.push(new tr(n))}()}catch(e){l=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw s}}return a}function kt(e){var t=e.data,r=e.field,a=e.model,i=e.onUpdate;return n.createElement(Fn,{criteria:r.criteria,data:t,elementType:r.elementType,limit:r.limit,modalStorageKey:"tcf_".concat(a.__type,"_").concat(r.name),onUpdate:i,sources:r.sources,viewMode:r.viewMode})}function wt(e){var t=e.data,r=e.onUpdate,a=e.field;return n.createElement(Ne,{onChange:r,options:a.options,value:t})}function St(e){var t;return e&&(t="color"in e?e.color:e.label),"string"==typeof t?t:"transparent"}function xt(e){var t=e.data,r=e.errors,a=e.onUpdate;return n.createElement("input",{autoComplete:"off",className:Ut("tcfTextWidget text fullwidth",{error:r&&r.length}),onChange:function(e){return a(e.target.value)},value:t?"".concat(t):""})}function Ot(e){var t=e.data,r=e.onUpdate;return n.createElement("textarea",{className:"tcfTextareaWidget text fullwidth",onChange:function(e){return r(e.target.value)},value:t})}e=e&&e.hasOwnProperty("default")?e.default:e;var Nt="default"in t?t.default:t;i=i&&i.hasOwnProperty("default")?i.default:i,s=s&&s.hasOwnProperty("default")?s.default:s;var Rt,It=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"initialize",value:function(e){this.definitions=e}},{key:"createValue",value:function(e){return this.getDefinition(e.field).createValue(e)}},{key:"getDefinition",value:function(e){return this.definitions["object"===_typeof(e)?e.type:e]}}]),e}()),At={addReferences:R,changeType:P,moveModel:L,setOverlay:U,uuidOrder:ne,uuidRemove:x,updateSync:K,updateValue:J},Mt=[ae,N,b,oe,ie,C,E,le];!function(e){e[e.Manipulation=0]="Manipulation",e[e.Movement=1]="Movement",e[e.Clipboard=2]="Clipboard"}(Rt||(Rt={}));var Pt;!function(e){e[e.Idle=0]="Idle",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded"}(Pt||(Pt={}));var Tt,jt,Lt=null,Dt=Pt.Idle,Ut=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){!function(){function t(){for(var e=[],r=0;r<arguments.length;r++){var a=arguments[r];if(a){var i=_typeof(a);if("string"===i||"number"===i)e.push(a);else if(Array.isArray(a)&&a.length){var o=t.apply(null,a);o&&e.push(o)}else if("object"===i)for(var l in a)n.call(a,l)&&a[l]&&e.push(l)}}return e.join(" ")}var n={}.hasOwnProperty;e.exports?(t.default=t,e.exports=t):window.classNames=t}()}),Wt="toolbar";!function(e){e[e.Small=0]="Small",e[e.Large=1]="Large"}(jt||(jt={}));var Vt=n.createContext(jt.Large),Ft=r.connect(function(e,t){return{schema:e.schemas[t.model.__type]}},function(e,t){return{onUpdate:function(n,r){e(Z(t.path,n,r))}}})(be);!function(e){function t(e){var t=e.children;return n.createElement("div",{className:"tcfWindow--content"},t)}function r(e){var t=e.children;return n.createElement("div",{className:"tcfWindow--footer"},t)}e.Content=t,e.Footer=r}(Ee||(Ee={}));var zt=Ee,Ht=n.createContext({expanded:[],isExpanded:function(){return!1},toggleExpanded:function(){}}),Bt=function(e){function t(e){var n;return _classCallCheck(this,t),n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)),n.originalModel=null,n.handleCancel=function(){n.close()},n.handleApply=function(){n.close()},n.originalModel=e.model,n}return _inherits(t,e),_createClass(t,[{key:"close",value:function(){this.props.setOverlay(null)}},{key:"render",value:function(){var e=this.props,t=e.model,r=e.path;return n.createElement(ke,null,n.createElement(zt,null,n.createElement(zt.Content,null,n.createElement(Ft,{model:t,path:r})),n.createElement(zt.Footer,null,n.createElement(pe,{onClick:this.handleApply},n.createElement(_e,{value:"OVERLAY_EDIT_INSTANCE_APPLY"})))))}}]),t}(n.Component),qt=r.connect(function(e,t){return h(e,t.uuid)},function(e){return{setOverlay:function(t){return e(W(t))}}})(Bt),Xt="craft:",Yt="material:",$t=n.createContext(0),Gt=r.connect(function(e,t){return{schemas:t.schemaNames.map(function(t){return e.schemas[t]})}},function(e,t){return{onChangeType:function(n){return e(T(t.path,n))}}})(Re),Kt=function(e){function t(e){var n;_classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).element=null,n.handleMouseDown=function(e){var t=n.props.onClick;e.target===n.element&&t&&t()};var r=document.createElement("div");return r.className="tcfOverlay",r.addEventListener("mousedown",n.handleMouseDown),document.body.appendChild(r),n.element=r,n}return _inherits(t,e),_createClass(t,[{key:"componentWillUnmount",value:function(){var e=this.element;e&&(document.body.removeChild(e),e.removeEventListener("mousedown",this.handleMouseDown),this.element=null)}},{key:"render",value:function(){var e=this.props.children,t=this.element;return t?a.createPortal(e,t):null}}]),t}(n.Component),Qt=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.id=A(),e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.id,t=this.props,r=t.className,a=t.children,i=t.onChange,o=t.value;return n.createElement("dl",{className:Ut("tcfCheckbox",r)},n.createElement("dd",{className:"tcfCheckbox--input"},n.createElement("input",{checked:o,id:e,onChange:function(){return i(!o)},type:"checkbox"})),n.createElement("dt",{className:"tcfCheckbox--label"},n.createElement("label",{htmlFor:e},a)))}}]),t}(n.Component),Jt=function(e){function t(e){var n;return _classCallCheck(this,t),n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)),n.handleApply=function(){var e=n.props,t=e.currentSite,r=e.endpoint,a=n.state,i=a.site,o=a.useTranslator;if(i){var l;o&&t&&i.language!==t.language&&(l={endpoint:r,source:i.language,target:t.language}),n.props.onSynchronize({siteId:i.id,translate:l})}},n.handleSiteChange=function(e){n.setState({site:e})},n.handleToggleTranslator=function(e){n.setState({useTranslator:e})},n.state={site:e.availableSites[0]||null,useTranslator:!1},n}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.availableSites,r=e.currentSite,a=e.onClose,i=this.state,o=i.site,l=i.useTranslator,s=t.map(function(e){return{label:e.label,key:e}});return n.createElement("div",null,n.createElement("div",{className:"tcfSynchronize--title"},n.createElement(_e,{value:"Synchronize sites"})),n.createElement(ve,null,n.createElement(ge,{label:"Source site"},n.createElement(Ne,{onChange:this.handleSiteChange,options:s,value:o})),o&&r&&o.language!==r.language?n.createElement(Qt,{onChange:this.handleToggleTranslator,value:l},n.createElement(_e,{value:"Use machine translation for all texts"})):null),n.createElement("div",{className:"tcfSynchronize--actions"},n.createElement(pe,{onClick:this.handleApply},n.createElement(_e,{value:"Apply"})),n.createElement(pe,{onClick:a,secondary:!0},n.createElement(_e,{value:"Cancel"}))))}}]),t}(n.Component),Zt=r.connect(function(e){var t=e.config,n=t.elementSiteId,r=t.apiEndpoints,a=t.supportedSites;return{availableSites:a.filter(function(e){return e.id!==n}),currentSite:a.find(function(e){return e.id===n}),endpoint:r.translate}},function(e){return{onSynchronize:function(t){return e(te(t))}}})(Jt),en=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.state={isSynchronizing:!1},e.handleOverlayClose=function(){e.props.onSetOverlay(null)},e.handleSyncClose=function(){var t=e.props,n=t.onUpdateSync;"working"!==t.sync.status&&(n({status:"idle"}),e.setState({isSynchronizing:!1}))},e.handleSyncStart=function(){e.setState({isSynchronizing:!0})},e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.canSynchronize,r=e.model,a=e.overlay,i=e.schemas,o=e.sync,l=this.state.isSynchronizing;return n.createElement(ke,null,n.createElement(ye,null,n.createElement(Gt,{model:r,path:[],schemaNames:i}),t?n.createElement("div",{className:"tcfRoot--options"},n.createElement(pe,{onClick:this.handleSyncStart},n.createElement(Se,{name:"material:sync"}),n.createElement(_e,{value:"Synchronize"}))):null,l||"idle"!==o.status?n.createElement(Kt,{onClick:this.handleSyncClose},n.createElement(Te,{onClose:this.handleSyncClose,sync:o})):null,a?n.createElement(Kt,{onClick:this.handleOverlayClose},we(a)):null))}}]),t}(n.Component),tn=o.DragDropContext(i)(r.connect(function(e){return{canSynchronize:e.config.supportedSites.length>1,model:e.model,overlay:e.overlay,schemas:e.config.rootSchemas,sync:e.sync}},function(e){return{onSetOverlay:function(t){return e(W(t))},onUpdateSync:function(t){return e(Q(t))}}})(en)),nn=function(e){function n(e){var t;return _classCallCheck(this,n),_possibleConstructorReturn(this,(t=_getPrototypeOf(n)).call.apply(t,[this].concat(_toConsumableArray(Ue(e)))))}return _inherits(n,e),_createClass(n,[{key:"toHTML",value:function(){return new t.SafeString(this.toString())}},{key:"toString",value:function(){return this.map(function(e){return De(e)}).join("")}},{key:"asList",get:function(){return new t.SafeString("<ul>".concat(this.map(function(e){return"<li>".concat(De(e),"</li>")}).join(""),"</ul>"))}}]),n}(_wrapNativeSuper(Array)),rn=We(function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.handleDelete=function(){var t=e.props,n=t.index;(0,t.onDelete)(n)},e.handleUpdate=function(t){var n=e.props,r=n.index;(0,n.onUpdate)(r,t)},e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.child,r=e.dragPreview,a=e.dragSource,i=e.field,o=e.hasDropTarget,l=e.index,s=e.isDragging,c=e.model,u=e.path;return n.createElement("div",{className:Ut("tcfArrayWidgetMember",{hasDropTarget:o,isDragging:s})},r(n.createElement("div",{className:"tcfArrayWidgetMember--panel"},n.createElement("div",{className:"tcfArrayWidgetMember--header"},a(n.createElement("div",{className:"tcfArrayWidgetMember--headerHandle"},n.createElement(Se,{className:"tcfArrayWidgetMember--headerHandleIcon",key:"handle",name:"move"}),n.createElement("span",null,"Member #".concat(l+1)))),n.createElement("div",{className:"tcfArrayWidgetMember--headerActions"},n.createElement(pe,{onClick:this.handleDelete},n.createElement(Se,{name:"remove"}),n.createElement(_e,{value:"Delete"})))),n.createElement("div",{className:"tcfArrayWidgetMember--body"},n.createElement(me,{data:t,errors:[],field:i,model:c,onUpdate:this.handleUpdate,path:u})))))}}]),t}(n.Component)),an=o.DropTarget("MEMBER",{canDrop:function(e,t){var n=t.getItem(),r=n.data,a=n.path,i=e.data,o=e.field,l=e.limit,s=e.path,c=a.slice(),u=c.pop();if(!(u&&"index"===u.type&&Fe(c,s)&&o.name===u.name)&&l>0&&i.length>=l)return!1;switch(e.field.type){case"instance":return d(r)&&-1!==e.field.schemas.indexOf(r.__type);default:return!0}},drop:function(e,t,n){if(!t.didDrop()){var r=t.getItem();return e.onMove({source:r.path,target:e.path,targetField:e.field.name,targetIndex:n.getDropIndex(t)}),{executed:!0}}},hover:function(e,t,n){n.handleDragHover(t)}},function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver({shallow:!0})&&t.canDrop()}}),on=function(e){function t(e){var n;return _classCallCheck(this,t),n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)),n.element=null,n.handleAnimationEnd=function(){var e=_assertThisInitialized(n).element;e&&(e.style.height="",e.style.transition=""),n.setState({inTransition:!1,lastChildren:null,lastUri:null})},n.setElement=function(e){n.element=e},n.state={currentChildren:e.children,currentUri:e.uri,inTransition:!1,lastChildren:null,lastUri:null},n}return _inherits(t,e),_createClass(t,[{key:"componentDidUpdate",value:function(e,t,n){var r=this.element;r&&n&&setTimeout(function(){r.style.height="";var e=r.offsetHeight;r.style.height="".concat(n.height,"px"),r.getBoundingClientRect(),r.style.transition="height 200ms",r.style.height="".concat(e,"px")},0)}},{key:"getSnapshotBeforeUpdate",value:function(e,t){var n=this.element;if(t.currentUri!==this.state.currentUri&&n){var r=n.offsetHeight;return n.style.height="".concat(r,"px"),{height:r}}return null}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.itemClassName,a=this.state,i=a.currentChildren,o=a.currentUri,l=a.inTransition,s=a.lastChildren,c=a.lastUri,u=[];return l&&c&&u.push(n.createElement("div",{className:Ut(r,"tcfDetailsPanel--item","from"),key:c},s)),u.push(n.createElement("div",{className:Ut(r,"tcfDetailsPanel--item",{to:l}),key:o,onAnimationEnd:this.handleAnimationEnd},i)),n.createElement("div",{className:Ut(t,"tcfDetailsPanel"),ref:this.setElement},u)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.uri===t.currentUri?Object.assign({},t,{currentChildren:e.children}):e.uri===t.currentUri||t.inTransition?null:{inTransition:!0,lastChildren:t.currentChildren,lastUri:t.currentUri,currentChildren:e.children,currentUri:e.uri}}}]),t}(n.Component),ln=r.connect(function(e,t){return{commands:se(e,t.uuid)}},function(e){return{dispatch:e}})(Be),sn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.handle=null,e.handleStyle={left:"0px"},e.origin=null,e.panel=null,e.panelClassName="tcfFlyout--panel",e.panelStyle={left:"0px",top:"0px"},e.handleResize=function(){e.update()},e.setHandle=function(t){e.handle=t,e.update()},e.setOrigin=function(t){e.origin=t,e.update()},e.setPanel=function(t){e.panel=t,e.update()},e}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.onClick;return n.createElement("div",{className:"tcfFlyout",ref:this.setOrigin},n.createElement(Kt,{onClick:r},n.createElement("div",{className:this.panelClassName,ref:this.setPanel,style:Object.assign({},this.panelStyle)},n.createElement("div",{className:"tcfFlyout--handle",ref:this.setHandle,style:Object.assign({},this.handleStyle)}),t)))}},{key:"update",value:function(){var e=this.handle,t=this.handleStyle,n=this.origin,r=this.panel,a=this.panelStyle;if(n&&r&&e){var i=n.getBoundingClientRect(),o=r.getBoundingClientRect(),l="tcfFlyout--panel",s=Math.max(10,Math.min(window.innerWidth-o.width-10,i.left+.5*(i.width-o.width))),c=Math.max(10,Math.min(o.width-10,i.left+.5*i.width-s));t.left="".concat(c,"px"),a.left="".concat(s,"px"),i.top+.5*i.height>.5*window.innerHeight?(l+=" above",a.top="".concat(i.top-o.height-5,"px")):(l+=" below",a.top="".concat(i.top+i.height+5,"px")),e.style.left=t.left,r.className=this.panelClassName=l,r.style.left=a.left,r.style.top=a.top}}}]),t}(n.Component),cn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.state={isExpanded:!1},e.handleClose=function(){e.setState({isExpanded:!1})},e.handleClick=function(){e.setState({isExpanded:!0})},e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props.uuid,t=this.state.isExpanded;return n.createElement("div",{className:"tcfArrayWidgetMember--headerMore"},n.createElement("div",{className:"tcfArrayWidgetMember--headerMoreButton",onClick:this.handleClick},n.createElement(Se,{name:"material:more_vert"})),t?n.createElement(sn,{onClick:this.handleClose},n.createElement(ln,{onClose:this.handleClose,uuid:e})):null)}}]),t}(n.Component),un=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.className,r=e.field,a=e.i18nCategory,i=e.model,o=e.onClick,l=e.references,s=e.schemas,c=It.getDefinition("instance").preview({context:{depth:0,i18nCategory:a,references:l,schemas:s},field:r,value:i});try{var u={__html:De(c)};return n.createElement("div",{className:Ut("tcfInstancePreview",t),dangerouslySetInnerHTML:u,onClick:o})}catch(e){return n.createElement("div",{className:t},n.createElement("p",null,n.createElement("span",{className:"tcfIcon material"},"error"),n.createElement("span",null,"Could not render preview.")),e&&"object"===_typeof(e)&&"message"in e?n.createElement("pre",null,e.message):null)}}},{key:"shouldComponentUpdate",value:function(e){return e.model!==this.props.model}}]),t}(n.Component),dn=r.connect(function(e){return{i18nCategory:e.config.i18nCategory,references:e.config.references,schemas:e.schemas}})(un),fn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.handleDelete=function(){var t=e.props,n=t.index;(0,t.onDelete)(n)},e.handleToggleExpanded=function(){(0,e.context.toggleExpanded)(e.props.child.__uuid)},e.handleUpdate=function(t){var n=e.props,r=n.index;(0,n.onUpdate)(r,t)},e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.child,r=e.depth,a=e.dragPreview,i=e.dragSource,o=e.field,l=e.hasDropTarget,s=e.isCollapsible,c=e.isCompact,u=e.isDragging,d=e.path,f=e.schema,h=!1;if(f){var p=Object.keys(f.fields);1===p.length&&"redactor"===f.fields[p[0]].type&&(h=!0)}var m,v=this.context.isExpanded(t.__uuid),g=!s||v;return m=g?n.createElement("div",{className:"tcfArrayWidgetMember--body"},n.createElement(Gt,{canChangeType:!1,isBorderless:h,model:t,path:d,schemaNames:o.schemas})):n.createElement(dn,{className:"tcfArrayWidgetMember--preview",field:o,model:t,onClick:this.handleToggleExpanded}),n.createElement("div",{className:Ut("tcfArrayWidgetMember depth-".concat(r),{hasDropTarget:l,isCompact:c,isDragging:u})},a(n.createElement("div",{className:Ut("tcfArrayWidgetMember--panel",{isExpanded:g})},n.createElement(qe,{dragSource:i,isCollapsible:s,isExpanded:g,model:t,onDelete:this.handleDelete,onToggleExpanded:this.handleToggleExpanded,schema:f}),n.createElement(on,{uri:v?"details":"summary"},m))))}}]),t}(n.Component);fn.contextType=Ht;var hn=We(fn),pn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.element=null,e.state={dropIndex:-1,placeholderHeight:0},e.setElement=function(t){e.element=t},e}return _inherits(t,e),_createClass(t,[{key:"getDropIndex",value:function(e){var t=e.getClientOffset(),n=this.element,r=this.props.data.length;if(n&&t)for(var a=document.elementFromPoint(t.x,t.y);a;){if(a.parentElement===n){if(a.classList.contains("tcfArrayWidgetList--placeholder"))return this.state.dropIndex;var i=a.getBoundingClientRect(),o=t.y>i.top+.5*i.height;r=Xe(a)+(o?1:0);break}a=a.parentElement}return r}},{key:"handleDragHover",value:function(e){this.setState({dropIndex:this.getDropIndex(e),placeholderHeight:e.getItem().height})}},{key:"render",value:function(){var e=this.state,t=e.dropIndex,r=e.placeholderHeight,a=this.props,i=a.children,o=a.connectDropTarget,l=a.isCompact,s=a.isOver,c=this.renderMembers();if(s){var u=n.createElement("div",{className:Ut("tcfArrayWidgetList--placeholder",{isCompact:l}),key:"placeholder",style:{height:r}});t<=0?c.unshift(u):t>=c.length?c.push(u):c.splice(t,0,u)}var d;return 0===c.length?c.push(n.createElement("div",{className:"tcfArrayWidgetList--empty",key:"empty"},i)):d=n.createElement("div",{className:"tcfArrayWidgetList--footer"},i),n.createElement(n.Fragment,null,o(n.createElement("div",{className:"tcfArrayWidgetList",ref:this.setElement},c)),d)}},{key:"renderMembers",value:function(){var e=this.props,t=e.data,r=e.field,a=e.isCollapsible,i=e.isCompact,o=e.model,l=e.onDelete,s=e.onUpdate,c=e.path,u=e.schemas,f=this.context;return t.map(function(e,t){var h=[].concat(_toConsumableArray(c),[{index:t,name:r.name,type:"index"}]),p={index:t,isCollapsible:a,key:d(e)?e.__uuid:t,model:o,onDelete:l,onUpdate:s,path:h};return d(e)&&"instance"===r.type?n.createElement(hn,Object.assign({},p,{child:e,depth:f,field:r,isCompact:i,schema:u[e.__type]})):n.createElement(rn,Object.assign({},p,{child:e,depth:f,field:r,isCompact:i}))})}}]),t}(n.PureComponent);pn.contextType=$t;var mn=r.connect(function(e){return{schemas:e.schemas}},function(e){return{onMove:function(t){return e(D(t))}}})(an(pn)),vn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.handleAdd=function(t){var n=_assertThisInitialized(e).context,r=e.props,a=r.data,i=r.onUpdate,o=Array.isArray(a)?a.slice():[];o.push(t),i(o),d(t)&&n&&n.toggleExpanded(t.__uuid,!0)},e.handleDelete=function(t){var n=e.props,r=n.data,a=n.onUpdate;if(Array.isArray(r)){var i=r.slice();i.splice(t,1),a(i)}},e.handleUpdate=function(t,n){var r=e.props,a=r.data,i=r.onUpdate;if(Array.isArray(a)){var o=a.slice();o[t]=n,i(o)}},e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.field,r=e.data,a=e.model,i=e.path,o=t.limit;if(!t.member)return null;var l,s=Array.isArray(r)?r:[],c=o>0&&s.length>=o,u=It.getDefinition(t.member);return u&&!c&&(l=n.createElement(u.factory,{field:t.member,onCreate:this.handleAdd})),n.createElement(mn,{data:s,field:t.member,isCollapsible:t.collapsible,isCompact:t.compact,limit:o,model:a,onDelete:this.handleDelete,onUpdate:this.handleUpdate,path:i},l)}}]),t}(n.Component);vn.contextType=Ht;var gn,yn=r.connect(function(e,t){return{schemas:e.schemas}})($e),Cn=function(){function e(t){var n=t.factory,r=t.widget;_classCallCheck(this,e),this.factory=n||yn,this.widget=r}return _createClass(e,[{key:"cloneValue",value:function(e){return F(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.field,r=e.value,!this.isValue(n,r)){t.next=5;break}return t.abrupt("return",Ye(r));case 5:return t.abrupt("return",this.createValue(e));case 6:case"end":return t.stop()}},t,this)}))}}]),e}(),bn=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:vn}))}return _inherits(t,e),_createClass(t,[{key:"cloneValue",value:function(e){return F(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,a,i,o,l,s,c,u,d,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.field,r=e.value,a=V(e,["field","value"]),!this.isValue(n,r)){t.next=36;break}i=It.getDefinition(n.member.type),o=[],l=!0,s=!1,c=void 0,t.prev=7,u=r[Symbol.iterator]();case 9:if(l=(d=u.next()).done){t.next=19;break}return f=d.value,t.t0=o,t.next=14,i.cloneValue(Object.assign({},a,{field:n.member,value:f}));case 14:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 16:l=!0,t.next=9;break;case 19:t.next=25;break;case 21:t.prev=21,t.t2=t.catch(7),s=!0,c=t.t2;case 25:t.prev=25,t.prev=26,l||null==u.return||u.return();case 28:if(t.prev=28,!s){t.next=31;break}throw c;case 31:return t.finish(28);case 32:return t.finish(25);case 33:return t.abrupt("return",o);case 36:return t.abrupt("return",this.createValue(e));case 37:case"end":return t.stop()}},t,this,[[7,21,25,33],[26,,28,32]])}))}},{key:"createValue",value:function(e){return[]}},{key:"isValue",value:function(e,t){return Array.isArray(t)}},{key:"preview",value:function(e){return new nn(e)}}]),t}(Cn),En=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"createValue",value:function(e){return!!e.field.defaultValue}},{key:"isValue",value:function(e,t){return"boolean"==typeof t}},{key:"preview",value:function(e){return e.value}}]),t}(Cn),_n=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:Ge})),e.isAlwaysPlainField=!0,e}return _inherits(t,e),t}(En),kn=n.createContext({css:"#000",hsv:{hue:0,saturation:0,value:0,alpha:0},rgb:{red:0,green:0,blue:0,alpha:0},onHsvColor:function(e){},onRgbColor:function(e){}}),wn=function(e){function t(e){var n;return _classCallCheck(this,t),n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)),n.timeout=null,n.commit=function(){null!==n.timeout&&window.clearTimeout(n.timeout),n.timeout=window.setTimeout(n.handleTimeout,250)},n.handleHsvColor=function(e){var t=et(e);n.setState({css:tt(t),rgb:t,hsv:e}),n.commit()},n.handleRgbColor=function(e){n.setState({css:tt(e),rgb:e,hsv:rt(e)}),n.commit()},n.handleTimeout=function(){n.timeout=null,n.props.onChange(n.state.rgb)},n.state={css:tt(e.color),hsv:rt(e.color),rgb:Object.assign({},e.color)},n}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props.children;return n.createElement(kn.Provider,{value:Object.assign({},this.state,{onHsvColor:this.handleHsvColor,onRgbColor:this.handleRgbColor})},e)}}]),t}(n.Component),Sn=at(function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.state={hasFocus:!1},e.handleBlur=function(){e.setState({hasFocus:!1})},e.handleChange=function(t){var n=t.target.value;(0,e.props.onRgbColor)(e.getColor(n))},e.handleFocus=function(){e.setState({hasFocus:!0})},e}return _inherits(t,e),_createClass(t,[{key:"getValue",value:function(){var e=this.props,t=e.rgb,n=e.type;switch(n){case"alpha":case"blue":case"green":case"red":return"".concat(t[n]);case"hex":return nt(t)}}},{key:"getColor",value:function(e){var t=this.props,n=t.rgb,r=t.type;switch(r){case"blue":case"green":case"red":var a=parseInt(e);return Object.assign({},n,_defineProperty({},r,isFinite(a)?Math.max(0,Math.min(255,a)):n[r]));case"alpha":var i=parseFloat(e);return Object.assign({},n,{alpha:isFinite(i)?Math.max(0,Math.min(1,i)):n.alpha});case"hex":var o=Ze(e);return o?Object.assign({},o,{alpha:n.alpha}):n}}},{key:"render",value:function(){var e=this.state.hasFocus,t={className:"tcfColorInputInput",onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus};return e?t.defaultValue=this.getValue():t.value=this.getValue(),n.createElement(it,t)}}]),t}(n.Component)),xn=at(function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.element=null,e.state={initialHue:0,isMouseDown:!1,mouseX:0,mouseY:0},e.handleMouseDown=function(t){var n=e.props.hsv;window.addEventListener("mousemove",e.handleMouseMove),window.addEventListener("mouseup",e.handleMouseUp),e.setState(Object.assign({},e.update(t.clientX,t.clientY,n.hue),{initialHue:n.hue,isMouseDown:!0}))},e.handleMouseMove=function(t){e.setState(e.update(t.clientX,t.clientY))},e.handleMouseUp=function(t){e.stopListening(),e.setState(Object.assign({},e.update(t.clientX,t.clientY),{isMouseDown:!1}))},e.setElement=function(t){e.element=t},e}return _inherits(t,e),_createClass(t,[{key:"componentWillUnmount",value:function(){this.stopListening()}},{key:"render",value:function(){var e=this.props.hsv,t=this.state,r=t.initialHue,a=t.isMouseDown,i=t.mouseX,o=t.mouseY;return n.createElement("div",{className:"tcfColorInputSaturation",onMouseDown:this.handleMouseDown,ref:this.setElement,style:{background:"hsl(".concat(360*(a?r:e.hue),", 100%, 50%)")}},n.createElement("div",{className:"tcfColorInputSaturation--value",style:{left:"".concat(100*(a?i:e.saturation),"%"),top:"".concat(100*(a?o:1-e.value),"%")}}))}},{key:"stopListening",value:function(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"update",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.initialHue,r=this.element;if(!r)return{mouseX:this.state.mouseX,mouseY:this.state.mouseY};var a=this.props,i=a.hsv,o=a.onHsvColor,l=r.getBoundingClientRect(),s=Math.max(0,Math.min(1,(e-l.left)/l.width)),c=Math.max(0,Math.min(1,(t-l.top)/l.height));return o({alpha:i.alpha,hue:n,saturation:s,value:1-c}),{mouseX:s,mouseY:c}}}]),t}(n.Component)),On=at(function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.element=null,e.handleMouseDown=function(t){window.addEventListener("mousemove",e.handleMouseMove),window.addEventListener("mouseup",e.handleMouseUp),e.update(t.clientX)},e.handleMouseMove=function(t){e.update(t.clientX)},e.handleMouseUp=function(t){e.stopListening(),e.update(t.clientX)},e.setElement=function(t){e.element=t},e}return _inherits(t,e),_createClass(t,[{key:"componentWillUnmount",value:function(){this.stopListening()}},{key:"render",value:function(){var e,t=this.props,r=t.rgb,a=t.hsv,i=t.type,o=a[i];if("alpha"===i){var l=r.red,s=r.green,c=r.blue,u="rgba(".concat(l,", ").concat(s,", ").concat(c,", 0)"),d="rgba(".concat(l,", ").concat(s,", ").concat(c,", 1)");e=n.createElement("div",{className:"tcfColorInputSlider--gradient",style:{background:"linear-gradient(to right, ".concat(u,", ").concat(d,")")}})}return n.createElement("div",{className:"tcfColorInputSlider ".concat(i),onMouseDown:this.handleMouseDown},e,n.createElement("div",{className:"tcfColorInputSlider--track",ref:this.setElement},n.createElement("div",{className:"tcfColorInputSlider--handle",style:{left:"".concat(100*o,"%")}})))}},{key:"stopListening",value:function(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"update",value:function(e){var t=this.element;if(t){var n=this.props,r=n.hsv,a=n.onHsvColor,i=n.type,o=t.getBoundingClientRect(),l=Math.max(0,Math.min(1,(e-o.left)/o.width));a(Object.assign({},r,_defineProperty({},i,l)))}}}]),t}(n.Component)),Nn=at(ot),Rn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.state={hasColorPicker:!1},e.handleChange=function(t){e.props.onChange(t)},e.handleSwatchClick=function(){e.setState({hasColorPicker:!0})},e.handleOverlayClick=function(){e.setState({hasColorPicker:!1})},e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.state.hasColorPicker,t=this.props,r=t.color,a=t.disableAlpha,i=t.onChange,o=t.presetColors;return n.createElement(wn,{color:r,onChange:i},n.createElement("div",{className:"tcfColorInput"},n.createElement(Nn,{className:"tcfColorInput--swatch",onClick:this.handleSwatchClick},e?n.createElement(sn,{onClick:this.handleOverlayClick},n.createElement(lt,{disableAlpha:a,presetColors:o})):null),n.createElement(Sn,{type:"hex"})))}}]),t}(n.Component),In=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:st}))}return _inherits(t,e),_createClass(t,[{key:"createValue",value:function(e){return Qe()}},{key:"isValue",value:function(e,t){return Je(t)}},{key:"preview",value:function(e){e.context,e.value;return""}}]),t}(Cn),An=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.request=null,e.state={mode:"idle"},e.handleChange=function(t){e.updateOEmbed(),e.setState({mode:"typing"}),e.props.onUpdate(Object.assign({},e.getOEmbed(),{url:t.target.value}))},e.updateOEmbed=ct(function(){e.setState({mode:"loading"});var t=e.props,n=t.apiEndpoint,r=t.model,a=t.field,i=["schema=".concat(encodeURIComponent(r.__type)),"field=".concat(encodeURIComponent(a.name)),"url=".concat(encodeURIComponent(e.getOEmbed().url))],o=new XMLHttpRequest;o.onreadystatechange=function(){return e.handleRequestStateChange(o)},o.onerror=function(){return e.handleRequestError()},o.open("GET","".concat(n,"&").concat(i.join("&"))),o.send(),e.request&&e.request.abort(),e.request=o},500),e}return _inherits(t,e),_createClass(t,[{key:"getOEmbed",value:function(){var e=this.props.data;return ft(e)?e:{url:""}}},{key:"handleRequestStateChange",value:function(e){if(e.readyState===XMLHttpRequest.DONE){if(200!==e.status)return this.handleRequestError();var t;try{t=JSON.parse(e.responseText)}catch(e){return this.handleRequestError()}this.setState({mode:"idle"}),this.request=null,this.props.onUpdate(Object.assign({},this.getOEmbed(),{info:t.data}))}}},{key:"handleRequestError",value:function(){this.setState({mode:"idle"}),this.request=null,this.props.onUpdate(Object.assign({},this.getOEmbed(),{info:null}))}},{key:"render",value:function(){var e,t=this.getOEmbed(),r=this.state.mode;if("typing"===r||"loading"===r)e=n.createElement("div",{className:"tcfOEmbedWidget--activity"},n.createElement("div",{className:"tcfOEmbedWidget--activityBounce first"}),n.createElement("div",{className:"tcfOEmbedWidget--activityBounce second"}),n.createElement("div",{className:"tcfOEmbedWidget--activityBounce third"}));else if(t.info){var a=t.info,i=a.title,o=a.author_name,l=a.thumbnail_url;e=n.createElement("div",{className:"tcfOEmbedWidget--info"},l?n.createElement("img",{className:"tcfOEmbedWidget--infoImage",src:l}):null,n.createElement("div",{className:"tcfOEmbedWidget--infoContent"},n.createElement("div",{className:"tcfOEmbedWidget--infoTitle"},i),n.createElement("div",{className:"tcfOEmbedWidget--infoAuthor"},o)))}else e=n.createElement(dt,{title:"Invalid embed url"});return n.createElement("div",{className:"tcfOEmbedWidget"},n.createElement("div",{className:"tcfOEmbedWidget--input"},n.createElement("input",{autoComplete:"off",className:"text fullwidth",onChange:this.handleChange,value:t.url})),e)}}]),t}(n.Component),Mn=r.connect(function(e){return{apiEndpoint:e.config.apiEndpoints.oembed}})(An),Pn=function(){function e(t){_classCallCheck(this,e),this.value=t}return _createClass(e,[{key:"toHTML",value:function(){var e=this.value.info;if(!e)return new t.SafeString("");var n="";return e.thumbnail_url&&(n='<img class="tcfOEmbedWidget--infoImage" src="'.concat(e.thumbnail_url,'" />')),new t.SafeString('\n      <div class="tcfOEmbedWidget--info">\n        '.concat(n,'\n        <div class="tcfOEmbedWidget--infoContent">\n          <div class="tcfOEmbedWidget--infoTitle">').concat(e.title,'</div>\n          <div class="tcfOEmbedWidget--infoAuthor">').concat(e.author_name,"</div>\n        </div>\n      </div>\n    "))}},{key:"author",get:function(){return this.value.info?this.value.info.author_name:""}},{key:"thumbnail",get:function(){var e=this.value.info;return e&&e.thumbnail_url?new t.SafeString('<img width="100" src='.concat(e.thumbnail_url," />")):""}},{key:"title",get:function(){return this.value.info?this.value.info.title:""}}]),e}(),Tn=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:Mn}))}return _inherits(t,e),_createClass(t,[{key:"createValue",value:function(e){return{url:""}}},{key:"isValue",value:function(e,t){return ft(t)}},{key:"preview",value:function(e){var t=e.value;return new Pn(ft(t)?t:{url:""})}}]),t}(Cn),jn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.state={selectedSchema:null},e.handleCreate=function(){var t=e.props,n=t.available,r=t.onCreate,a=t.schemas,i=e.state.selectedSchema,o=1===n.length?n[0]:i;if(o)return r(M({schemas:a,schema:o}))},e.handleSchemaChange=function(t){e.setState({selectedSchema:t})},e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e,t=this.props,r=t.available,a=t.label,i=this.state.selectedSchema;if(r.length>1){var o=r.map(function(e){return{key:e,label:e.label}});o.sort(Oe),e=n.createElement(Ne,{onChange:this.handleSchemaChange,options:o,value:i})}return n.createElement("div",{className:"tcfFactory"},e,n.createElement(pe,{onClick:this.handleCreate,secondary:!0},n.createElement(_e,{value:a||"Create"}),n.createElement(Se,{name:"plus"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.available.length&&!t.selectedSchema){var n=e.available.slice();return n.sort(function(e,t){return e.label.localeCompare(t.label)}),{selectedSchema:n[0]}}return null}}]),t}(n.Component),Ln=r.connect(function(e,t){return{schemas:e.schemas,available:t.field.schemas.map(function(t){return e.schemas[t]})}})(jn),Dn=function(e){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,{factory:Ln,widget:ht}))}return _inherits(n,e),_createClass(n,[{key:"cloneValue",value:function(e){return F(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.field,r=e.value,a=V(e,["field","value"]),!this.isValue(n,r)){t.next=5;break}return t.abrupt("return",z(Object.assign({},a,{source:r})));case 5:return t.abrupt("return",this.createValue(e));case 6:case"end":return t.stop()}},t,this)}))}},{key:"createValue",value:function(e){var t=e.field,n=e.schema,r=e.schemas;if(n||(n=r[t.schemas[0]]),!n)throw new Error("The option `schema` is required when creating instances.");return M({schema:n,schemas:r})}},{key:"isValue",value:function(e,t){return d(t)}},{key:"preview",value:function(e){var n=e.context,r=e.value;if(!d(r))return"";var a=n.schemas[r.__type];if(!a)return"";var i=a.previewTemplate;if(null===i)return Craft.t(n.i18nCategory,a.label);var o={toHTML:function(){return new t.SafeString(i(o))},toString:function(){return i(o)}};o.depth=n.depth;for(var l=0,s=Object.keys(a.fields);l<s.length;l++){var c=s[l],u=a.fields[c],f=It.getDefinition(u);f&&(o[c]=f.preview({context:Object.assign({},n,{depth:n.depth+1}),field:u,value:r[c]}))}return o}}]),n}(Cn),Un=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.element=null,e.lightswitch=null,e.handleChange=function(){var t=e.props.onChange,n=_assertThisInitialized(e).lightswitch;n&&t(n.on)},e.setElement=function(t){e.element!==t&&(e.element=t,e.lightswitch&&(e.lightswitch.destroy(),e.lightswitch=null),t&&(e.lightswitch=new Craft.LightSwitch(t,{onChange:e.handleChange,value:e.props.value})))},e}return _inherits(t,e),_createClass(t,[{key:"componentDidUpdate",value:function(){var e=this.props.value,t=this.lightswitch;t&&t.on!==e&&t.toggle()}},{key:"render",value:function(){var e=this.props,t=(e.children,e.className),r=e.disabled,a=e.small,i=e.value;return n.createElement("div",null,n.createElement("div",{className:Ut("lightswitch",t,{disabled:r,on:i,small:a}),ref:this.setElement,tabIndex:0},n.createElement("div",{className:"lightswitch-container"},n.createElement("div",{className:"label on"}),n.createElement("div",{className:"handle"}),n.createElement("div",{className:"label off"}))))}}]),t}(n.Component),Wn=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:pt}))}return _inherits(t,e),t}(En),Vn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.element=null,e.renderedIds=[],e.uuid="element-".concat(A()),e.instance=null,e.isRendering=!1,e.handleAdd=function(t){var n=t.elements;if(!e.isRendering){var r=e.props,a=r.elementType;(0,r.onAddReferences)(n.map(function(e){return Object.assign({},e,{$element:$(e.$element[0].outerHTML),element:e.$element[0].outerHTML,type:a})})),e.handleChange()}},e.handleChange=function(){if(!e.isRendering){var t=e.props.onUpdate,n=e.getSelectedIds();e.renderedIds=n,t(n)}},e.setElement=function(t){if(e.element!==t){e.element=t;var n=_assertThisInitialized(e).instance;if(n&&(n.off("selectElements",e.handleAdd),n.off("removeElements",e.handleChange),n.elementSort&&n.elementSort.off("sortChange",e.handleChange),n.destroy(),e.instance=n=null),t){var r=e.props,a=r.criteria,i=r.elementType,o=r.limit,l=void 0===o?null:o,s=r.modalStorageKey,c=void 0===s?null:s,u=r.sourceElementId,d=r.sources,f=r.viewMode,h=void 0===f?"small":f;n=new Craft.BaseElementSelectInput({criteria:a,elementType:i,id:e.uuid,limit:l,modalStorageKey:c,name:e.uuid,sources:d,sourceElementId:u,viewMode:h}),e.instance=n,e.createReferences(),n.on("selectElements",e.handleAdd),n.on("removeElements",e.handleChange),n.elementSort&&n.elementSort.on("sortChange",e.handleChange)}}},e}return _inherits(t,e),_createClass(t,[{key:"componentDidUpdate",value:function(){var e=this.renderedIds,t=this.props.data||[];t.length===e.length&&t.every(function(t,n){return t===e[n]})||this.createReferences()}},{key:"createReferences",value:function(){var e=this.instance;if(e){this.isRendering=!0;var t=[];e.$elementsContainer.empty();var n=!0,r=!1,a=void 0;try{for(var i,o=this.getStoredReferences()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value,s=e.createNewElement(l);e.appendElement(s),t.push(l.id)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}e.resetElements(),this.renderedIds=t,this.isRendering=!1}}},{key:"getStoredReferences",value:function(){var e=this.props,t=e.data,n=e.elementType,r=e.references,a=[];if(!Array.isArray(t))return a;var i=!0,o=!1,l=void 0;try{for(var s,c=t[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)!function(){var e=s.value,t=r.find(function(t){return t.id===e&&t.type===n});t&&a.push(t)}()}catch(e){o=!0,l=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw l}}return a}},{key:"getSelectedIds",value:function(){var e=this.instance;if(!e)return[];for(var t=[],n=e.getSelectedElementIds(),r=e.getElements(),a=0;a<r.length;a++){var i=parseInt(r.eq(a).data("id"));-1!==n.indexOf(i)&&t.push(i)}return t}},{key:"render",value:function(){return n.createElement("div",{id:this.uuid,className:"elementselect",ref:this.setElement},n.createElement("div",{className:"elements"}),n.createElement("div",{className:"btn add icon dashed"},"Choose"))}}]),t}(n.Component),Fn=r.connect(function(e){return{references:e.config.references,sourceElementId:e.config.elementId}},function(e){return{onAddReferences:function(t){e(I(t))}}})(Vn),zn=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:yt}))}return _inherits(t,e),_createClass(t,[{key:"createValue",value:function(){return{elementId:0,openInNewWindow:!1,type:"url",url:""}}},{key:"isValue",value:function(e,t){return gt(t)}},{key:"preview",value:function(){return""}}]),t}(Cn),Hn=function(){function e(t){_classCallCheck(this,e),this.latitude=t.latitude,this.longitude=t.longitude}return _createClass(e,[{key:"createStaticMap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:75,r=this.latitude,a=this.longitude,i=de();if(!i)return new t.SafeString("");var o=["key=".concat(i),"center=".concat(encodeURIComponent("".concat(r,",").concat(a))),"markers=".concat(encodeURIComponent("size:small|".concat(r,",").concat(a))),"size=".concat(e,"x").concat(n),"zoom=15","maptype=roadmap"].join("&");return new t.SafeString('\n      <img src="https://maps.googleapis.com/maps/api/staticmap?'.concat(o,'" width="').concat(e,'" height="').concat(n,'" />\n    '))}},{key:"toHTML",value:function(){return this.createStaticMap()}}]),e}(),Bn=["address","street","country","zip","city"],qn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.autocomplete=null,e.input=null,e.state={isSearching:!1},e.handlePlaceChanged=function(){var t=_assertThisInitialized(e).autocomplete;if(t){var n=t.getPlace();n.geometry&&e.props.onLocation({latitude:n.geometry.location.lat(),longitude:n.geometry.location.lng()})}},e.handleResolve=function(){var t=e.props.places;t&&(e.setState({isSearching:!0}),t.findPlaceFromQuery({query:e.getResolveQuery(),fields:["formatted_address","geometry"]},e.handleResolveResults))},e.handleResolveResults=function(t){e.setState({isSearching:!1}),t||(t=[]),1===t.length?e.handleResultsSelect(t[0]):e.setState({results:t})},e.handleResultsSelect=function(t){var n=t.geometry.location;e.props.onLocation({latitude:n.lat(),longitude:n.lng()}),e.handleResultsCancel()},e.handleResultsCancel=function(){e.state.results&&e.setState({results:void 0})},e.setInput=function(t){var n=_assertThisInitialized(e).autocomplete;e.input=t,n&&(n.unbindAll(),n=null),t&&((n=new google.maps.places.Autocomplete(t)).setFields(["geometry"]),n.addListener("place_changed",e.handlePlaceChanged)),e.autocomplete=n},e}return _inherits(t,e),_createClass(t,[{key:"canResolve",value:function(){return""!==this.getResolveQuery()}},{key:"getResolveQuery",value:function(){for(var e=this.props.model,t=[],n=0,r=Bn;n<r.length;n++){var a=r[n];a in e&&"string"==typeof e[a]&&t.push(e[a].trim())}return t.join(", ")}},{key:"render",value:function(){var e;if(this.canResolve()){var t,r=this.state.results;r&&0===r.length?t=n.createElement(ut,{icon:"material:error"},"No locations found"):r&&(t=n.createElement(Ct,{onSelect:this.handleResultsSelect,results:r})),e=n.createElement("div",{className:"tcfLocationFieldSearch--resolve"},t?n.createElement(sn,{onClick:this.handleResultsCancel},t):null,n.createElement(pe,{onClick:this.handleResolve},n.createElement(_e,{value:"Resolve address"})))}return n.createElement("div",{className:"tcfLocationFieldSearch"},e,n.createElement("input",{className:"tcfLocationFieldSearch--input tcfInput",ref:this.setInput,type:"search"}))}}]),t}(n.Component),Xn=17;!function(e){e[e.Loading=0]="Loading",e[e.Error=1]="Error",e[e.Ready=2]="Ready"}(gn||(gn={}));var Yn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.element=null,e.marker=null,e.state={instance:null,loadState:gn.Loading},e.handleLocation=function(t){var n=e.state.instance;n&&(n.map.setZoom(Xn),n.map.setCenter({lat:t.latitude,lng:t.longitude})),e.props.onUpdate(t)},e.handleMarkerDragEnd=function(){var t=_assertThisInitialized(e).marker;if(t){var n=t.getPosition();e.props.onUpdate({latitude:n.lat(),longitude:n.lng()})}},e.setElement=function(n){var r=e.state.instance,a=_assertThisInitialized(e).marker;if(r&&(t.stashInstance(r),r=null),a&&(a.setMap(null),a.unbindAll(),a=null),n){r=t.createInstance(),n.appendChild(r.element);var i=r.map;i.setZoom(Xn),i.setCenter(e.getLatLng()),(a=new google.maps.Marker({draggable:!0,position:e.getLatLng(),map:i})).addListener("dragend",e.handleMarkerDragEnd)}e.element=n,e.marker=a,e.setState({instance:r})},e}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){var e=this;try{fe().then(function(){e.setState({loadState:gn.Ready})})}catch(e){this.setState({loadState:gn.Error})}}},{key:"getLatLng",value:function(){var e=this.props.data;return bt(e)?{lat:e.latitude,lng:e.longitude}:{lat:0,lng:0}}},{key:"render",value:function(){var e=this.state,t=e.loadState,r=e.instance,a=this.props.model,i=this.marker;i&&i.setPosition(this.getLatLng());var o;return o=t===gn.Loading?n.createElement(Me,null):t===gn.Error?n.createElement(dt,{title:"Could not load Google Maps"}):n.createElement(n.Fragment,null,n.createElement(qn,{model:a,onLocation:this.handleLocation,places:r?r.places:null}),n.createElement("div",{className:"tcfLocation--map",ref:this.setElement})),n.createElement("div",{className:"tcfLocation"},o)}}],[{key:"createInstance",value:function(){var e=this.instanceStash.pop();if(!e){var t=document.createElement("div");t.className="tcfLocation--mapInstance";var n=new google.maps.Map(t,{mapTypeControl:!1,streetViewControl:!1});e={element:t,map:n,places:new google.maps.places.PlacesService(n)}}return e}},{key:"stashInstance",value:function(e){var t=e.element,n=t.parentElement;n&&n.removeChild(t),this.instanceStash.push(e)}}]),t}(n.Component);Yn.instanceStash=[];var $n=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:Yn}))}return _inherits(t,e),_createClass(t,[{key:"createValue",value:function(e){var t=e.field;return bt(t.defaultValue)?Object.assign({},t.defaultValue):{latitude:0,longitude:0}}},{key:"isValue",value:function(e,t){return bt(t)}},{key:"preview",value:function(e){var t=e.value;return new Hn(t)}}]),t}(Cn),Gn=function(){function e(t){_classCallCheck(this,e),this.value=t}return _createClass(e,[{key:"toHTML",value:function(){return new t.SafeString(this.value)}},{key:"summary",get:function(){return new t.SafeString('<div class="snippet">'.concat(this.value,"</div>"))}}]),e}(),Kn=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.didRender=!1,e.element=null,e.instance=null,e.renderedValue="",e.uuid="element-".concat(A()),e.handleChange=function(t){if(e.didRender)return void(e.didRender=!1);e.renderedValue=t,e.props.onUpdate(t)},e.setElement=function(t){if(e.element!==t){e.element=t;var n=_assertThisInitialized(e).instance;n&&(n.redactor&&n.redactor.off("changed",e.handleChange),n.destroy(),n=null);var r=e.props,a=r.elementSiteId,i=r.field;t&&i.redactor&&(n=new Craft.RedactorInput(Object.assign({},i.redactor,{elementSiteId:a,id:e.uuid,redactorConfig:Object.assign({},i.redactor.redactorConfig)}))).redactor&&n.redactor.on("changed",e.handleChange),e.instance=n}},e}return _inherits(t,e),_createClass(t,[{key:"componentDidUpdate",value:function(){var e=this.instance,t=this.props,n=this.renderedValue;e&&t.data!=n&&(this.didRender=!0,this.renderedValue=t.data,e.redactor.source.setCode(t.data))}},{key:"render",value:function(){var e=this.props.data;return n.createElement("div",{className:"tcfRedactorWidget"},n.createElement("textarea",{defaultValue:"string"==typeof e?e:"",id:this.uuid,ref:this.setElement}))}}]),t}(n.Component),Qn=r.connect(function(e){return{elementSiteId:e.config.elementSiteId}})(Kn),Jn=0,Zn=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"cloneValue",value:function(e){return F(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.field,r=e.translate,a=e.value,!this.isValue(n,a)){t.next=9;break}if(!n.translatable||!r){t.next=6;break}return t.abrupt("return",Et(a,r));case 6:return t.abrupt("return",a);case 7:t.next=10;break;case 9:return t.abrupt("return","");case 10:case"end":return t.stop()}},t,this)}))}},{key:"createValue",value:function(e){return""}},{key:"isValue",value:function(e,t){return"string"==typeof t}},{key:"preview",value:function(e){return e.value}}]),t}(Cn),er=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:Qn}))}return _inherits(t,e),_createClass(t,[{key:"preview",value:function(e){var t=e.value;return new Gn(t)}}]),t}(Zn),tr=function(){function e(t){_classCallCheck(this,e),this.reference=t}return _createClass(e,[{key:"createPreview",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"large",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.reference.$element.clone(!1,!0);n.removeClass("large removable small"),n.addClass(e);var r=n.find(".elementthumb");if(r.length){var a=r.find("img")[0];a||((a=document.createElement("img")).srcset=r.attr("data-srcset")||"",r.append(a)),a.sizes="small"===e?"30px":"100px"}return t?'<div class="tcfInstancePreview--thumb '.concat(e,'">').concat(r?r.html():"","</div>"):n[0].outerHTML}},{key:"createSafePreview",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"large",n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new t.SafeString(this.createPreview(e,n))}},{key:"toHTML",value:function(){return new t.SafeString(this.toString())}},{key:"toString",value:function(){return this.createPreview()}},{key:"asBackground",get:function(){var e=this.reference.$element.find(".elementthumb").attr("data-srcset");if(!e)return null;var n=e.split(",").pop();return n?new t.SafeString('<div class="tcfInstancePreview--background" style="background-image: url(\''.concat(n.trim(),'\');"></div><div class="tcfInstancePreview--background blur" style="background-image: url(\'').concat(n.trim(),"');\"></div>")):null}},{key:"asLargeElement",get:function(){return this.createSafePreview("large",!1)}},{key:"asLargeImage",get:function(){return this.createSafePreview("large",!0)}},{key:"asSmallElement",get:function(){return this.createSafePreview("small",!1)}},{key:"asSmallImage",get:function(){return this.createSafePreview("small",!0)}}]),e}(),nr=function(e){function n(e){var t;return _classCallCheck(this,n),_possibleConstructorReturn(this,(t=_getPrototypeOf(n)).call.apply(t,[this].concat(_toConsumableArray(_t(e)))))}return _inherits(n,e),_createClass(n,[{key:"toHTML",value:function(){return new t.SafeString('<div class="tcfInstancePreview--elements">'.concat(this.toString(),"</div>"))}},{key:"toString",value:function(){for(var e=[],t=0;t<this.length;t++)e.push(De(this[t]));return e.join("")}},{key:"asBackground",get:function(){return this.length?this[0].asBackground:null}},{key:"asLargeElement",get:function(){return this.length?this[0].asLargeElement:null}},{key:"asLargeImage",get:function(){return this.length?this[0].asLargeImage:null}},{key:"asSmallElement",get:function(){return this.length?this[0].asSmallElement:null}},{key:"asSmallImage",get:function(){return this.length?this[0].asSmallImage:null}}]),n}(_wrapNativeSuper(Array)),rr=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:kt}))}return _inherits(t,e),_createClass(t,[{key:"createValue",value:function(e){return[]}},{key:"isValue",value:function(e,t){return Array.isArray(t)&&t.every(function(e){return"number"==typeof e})}},{key:"preview",value:function(e){return new nr(e)}}]),t}(Cn),ar=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"createValue",value:function(e){var t=e.field;return t.defaultValue&&this.isValue(t,t.defaultValue)?t.defaultValue:t.options[0].key}},{key:"isValue",value:function(e,t){return e.options.some(function(e){return e.key===t})}},{key:"preview",value:function(e){var t=e.field,n=e.value,r=t?t.options.find(function(e){return e.key===n}):void 0;return r?r.label:"-"}}]),t}(Cn),ir=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:wt}))}return _inherits(t,e),t}(ar),or=function(e){function t(){var e;return _classCallCheck(this,t),e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)),e.state={isExpanded:!1},e.handleFlyoutClick=function(){e.setState({isExpanded:!1})},e.handleSelect=function(t){e.props.onUpdate(t.key),e.setState({isExpanded:!1})},e.handleSwatchClick=function(t){t.currentTarget===t.target&&e.setState({isExpanded:!0})},e}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.data,r=e.field,a=this.state.isExpanded,i=r.options.find(function(e){return e.key===t});return n.createElement("div",{className:Ut("tcfSwatchColorWidget",{isUndecided:!i}),onClick:this.handleSwatchClick,style:{background:i?St(i):void 0}},a?this.renderFlyout(i):null)}},{key:"renderFlyout",value:function(e){var t=this,r=this.props.field;return n.createElement(sn,{onClick:this.handleFlyoutClick},n.createElement("div",{className:"tcfSwatchColorWidget--swatches"},r.options.map(function(r){return n.createElement("div",{className:Ut("tcfSwatchColorWidget--swatch",{isSelected:r===e}),key:r.key,onClick:function(){return t.handleSelect(r)},style:{background:St(r)}})})))}}]),t}(n.Component),lr=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:or}))}return _inherits(t,e),t}(ar),sr=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:xt}))}return _inherits(t,e),t}(Zn),cr=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{widget:Ot}))}return _inherits(t,e),t}(Zn);It.initialize({array:new bn,checkbox:new _n,color:new In,instance:new Dn,lightswitch:new Wn,link:new zn,location:new $n,oembed:new Tn,redactor:new er,reference:new rr,select:new ir,swatchcolor:new lr,text:new sr,textarea:new cr});var ur=[],dr={},fr={create:function(e){try{var t=document.getElementById(e);if(!t)throw new Error("Root element not found.");var i=t.querySelector(".tcfField--app"),o=t.querySelector('script[type="application/json"]'),l=t.querySelector("input.tcfField--model");if(!l||!i||!o)throw new Error("Missing components.");var u=c.createStore(Le,he(o,l),c.applyMiddleware(s));ur.push(u),u.subscribe(function(){l.value=JSON.stringify(u.getState().model)}),a.render(n.createElement(r.Provider,{store:u},n.createElement(tn,null)),i)}catch(e){console.error("Could not start content editor: "+e.message)}},getInstanceApi:function(e){for(var t=0,n=ur;t<n.length;t++){var r=n[t],a=h(r.getState(),e);return a?ce(r,a):null}},getValidator:function(e){return e in dr?dr[e]:null},registerValidator:function(e,t){dr[e]=t}};return fr}(jQuery,Handlebars,React,ReactRedux,ReactDOM,ReactDnDHTML5Backend,ReactDnD,_babelPolyfill,ReduxThunk,Redux);
